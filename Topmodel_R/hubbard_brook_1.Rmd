---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(raster)
library(rgdal)


setwd("C:/Users/feder/Documents/CUAHSI/repos/Aquaholics_Anonymous/data/hubbard_brook/")
str_name <- 'hubbard_clipped.tif'
imported_raster <- raster(str_name)
View(imported_raster)
plot(imported_raster)

```

```{r}
library(topmodel)
dem <- as.matrix(imported_raster)
hubbard_topidx <- topidx(dem, 10)$atb
image(hubbard_topidx)






```

```{r}
rainfall <- runif(240,0,0)
etp <- runif(240,0,0)
hubbard_flowlength <- flowlength(dem,c(218,860))
hubbard_drainagearea <- topidx(dem, 10)$area
hubbard_flowlength_vector <- as.vector(hubbard_flowlength)
if_na(hubbard_flowlength_vector, label=NULL) <- 9999
head(hubbard_flowlength_vector)
hubbard_flowlength_vector[is.na(hubbard_flowlength_vector)] <- 0
hubbard_drainagearea_vector <- as.vector(hubbard_drainagearea)
hubbard_drainagearea_vector[is.na(hubbard_drainagearea_vector)] <- 0

hubbard_delay<- cbind(hubbard_drainagearea_vector, hubbard_flowlength_vector)
head(hubbard_flowlength)

#define parameters
n <- 1


qs0 <- runif(n, min=0.0001, max=0.0002)
lnTe <- runif(n, min=-2, max=3)
m <- runif(n, min=0.1, max=0.1)
Sr0 <- runif(n, min=2, max=2)
SrMax <- runif(n, min=2, max=2)
td <- runif(n, min=0, max=3)
vch <- runif(n, min=100, max=2500)
vr <- runif(n, min=1, max=1)
k0 <- runif(n, min=0.36, max=0.36)
CD <- runif(n, min=0, max=5)
dt <- 1.0

parameters <- cbind(qs0,lnTe,m,Sr0,SrMax,td,vch,vr,k0,CD,dt)
hubbard_qsim <- topmodel(parameters, hubbard_topidx, hubbard_delay, rainfall, etp)



```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
