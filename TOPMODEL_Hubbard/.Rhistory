hubbard_sim<-topmodel(parameters, hubbard_topidx, delay, rain, ETp)
plot(hubbard_sim, type="l", col="blue")
plot(hubbard_topidx)
View(topidx_new)
topidx
plot(topidx)
plot(hubbard_raster)
View(hubbard_topidx_big)
View(hubbard_tiff)
image(hubbard_tiff)
hubbard_tiff_elevated<-hubbard_tiff+9999
View(hubbard_tiff_elevated)
hubbard_topidx_big_elevated<-topidx(hubbard_tiff, 10)$atb
View(hubbard_topidx_big_elevated)
hubbard_topidx_elevated<-make.classes(hubbard_topidx_big_elevated, 16)
plot(hubbard_topidx_elevated)
plot(hubbard_topidx)
plot(hubbard_topidx_elevated)
hubbard_topidx
topidx
plot(topidx)
hubbard_topidx<-make.classes(hubbard_topidx_big, 5)
hubbard_topidx_elevated<-make.classes(hubbard_topidx_big_elevated, 5)
hubbard_topidx
plot(hubbard_topidx)
plot(hubbard_topidx_elevated)
hubbard_sim<-topmodel(parameters, hubbard_topidx, delay, rain, ETp)
plot(hubbard_sim, type="l", col="blue")
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot1=plot(Qsim, type="l", col="red")
plot(hubbard_sim, type="l", col="blue")
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot1=plot(Qsim, type="l", col="red")
plot(hubbard_sim, type="l", col="blue")
View(creek_topoindex)
image(dem)
View(dem)
View(hubbard_tiff_elevated)
View(hubbard_tiff_elevated)
hubbard_topidx_withdem<-topidx(dem, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
hubbard_topidx_withdem<-make.classes(hubbard_topidx_big_withdem, 10)
hubbard_topidx_big_withdem
View(hubbard_topidx_withdem)
View(hubbard_topidx_big_withdem)
hubbard_topidx_withdem
plot(hubbard_topidx_withdem)
hubbard_topidx_withdem<-make.classes(hubbard_topidx_big_withdem, 11)
hubbard_topidx_withdem
plot(hubbard_topidx_withdem)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, rain, ETp)
plot(hubbard_sim, type="l", col="blue")
hubbard_topidx_withdem
plot(hubbard_topidx_withdem)
View(dem)
View(hubbard_topidx_big_withdem)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, rain, ETp)
plot(hubbard_sim, type="l", col="blue")
plot(hubbard_topidx_withdem)
zero_rain<-runiff(240,0,0)
zero_rain<-runif(240,0,0)
rain
View(huagrahuma)
View(huagrahuma)
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot1=plot(Qsim, type="l", col="red")
zero_rain<-runif(10000,0,0)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, zero_rain, ETp)
plot(hubbard_sim, type="l", col="blue")
Qsim <- topmodel(parameters,topidx, delay, zero_rain, ETp)
plot1=plot(Qsim, type="l", col="red")
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot1=plot(Qsim, type="l", col="red")
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, zero_rain, ETp)
plot(hubbard_sim, type="l", col="blue")
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, rain, ETp)
plot(hubbard_sim, type="l", col="blue")
plot(Qsim, type="l", col="red")
lines(Qsim, type="l", col="red")
plot(hubbard_sim, type="l", col="blue")
lines(Qsim, type="l", col="red")
lines(hubbard_sim, type="l", col="blue")
plot(Qsim, type="l", col="red")
lines(hubbard_sim, type="l", col="blue")
delay
raster(huagrahuma)
plot(hubbard_raster)
####################################################################
huagrahuma_raster<-raster(huagrahuma.dem)
data(huagrahuma)
attach(huagrahuma)
####################################################################
huagrahuma_raster<-raster(huagrahuma.dem)
image(dem)
delay
View(huagrahuma)
View(dem)
plot(hubbard_raster)
raster(hubbard_raster)
min(hubbard_raster)
View(dem)
dem[218,858]
hubbard_outlet<-outlet(dem, [218,858], 2)
hubbard_outlet<-outlet(dem, c[218,858], 2)
hubbard_outlet<-outlet(dem, dem[218,858], 2)
View(creek_topoindex_atb)
View(hubbard_topidx_big_withdem)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, [218,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[218,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
outlet
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2, na=F)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 1)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
outlet
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, [217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, c[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_withdem[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
outlet
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[858,217], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
View(hubbard_topidx_big_withdem)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[218,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[218,857], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[218,856], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[218,855], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, hubbard_topidx_big_withdem[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, dem[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, dem[217,858], 1)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, dem[217,858], 2)
outlet
huagrahuma
huagrahuma.dem
data(huagrahuma.dem)
huagrahuma.dem
View(huagrahuma.dem)
dem[218,858]
dem[217,858]
hubbard_outlet<-(hubbard_topidx_big_withdem, dem[217,858], 2)
hubbard_outlet<-outlet(hubbard_topidx_big_withdem, dem[217,858], 2)
outlet
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
getwd("C:/summer_institute_2019/Scaling_theme/R_Files/TOPMODEL/")
raster<-'hubbard_clipped.tif'
dem <-raster(raster)
image(dem)
dem <-as.matrix(dem)
is.na(dem)
new_dem=remove.na(dem, iftell = TRUE)
####################################################################
hubbard_raster<-raster("hubbard_clipped.tif")
plot(hubbard_raster)
hubbard_tiff<-readTIFF("hubbard_clipped.tif")
hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
hubbard_topidx<-make.classes(hubbard_topidx_big, 5)
hubbard_topidx_withdem<-make.classes(hubbard_topidx_big_withdem, 11)
hubbard_topidx
plot(hubbard_topidx)
hubbard_topidx_withdem
plot(hubbard_topidx_withdem)
hubbard_data<-read.csv("2016_hubbert_precip.csv")
hubbard_rain<-hubbard_data$ï..Precip_2016
typeof(hubbard_rain)
hubbard_flow<-hubbard_data$Streamflow
plot(hubbard_flow)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow)
dt <- 24
parameters <- cbind(qs0,lnTe,m,Sr0,Srmax,td,vch,vr,k0,CD,dt)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow)
m <- runif(n, min = 0.05, max = 0.05)
parameters <- cbind(qs0,lnTe,m,Sr0,Srmax,td,vch,vr,k0,CD,dt)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow)
hubbard_data<-read.csv("2016_hubbert_precip.csv")
hubbard_rain_mm<-hubbard_data$ï..Precip_2016_mm
typeof(hubbard_rain_mm)
hubbard_rain_m<-hubbard_data$ï..Precip_2016_mm
hubbard_data<-read.csv("2016_hubbert_precip.csv")
hubbard_rain_mm<-hubbard_data$ï..Precip_2016_mm
hubbard_rain_m<-hubbard_data$ï..Precip_2016_m
hubbard_flow_ls<-hubbard_data$Streamflow_l.s
hubbard_flow_m3d<-hubbard_data$Streamflow_m3.day
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain_m, ETp)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain_m, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow_m3d)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow_ls)
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
getwd("C:/summer_institute_2019/Scaling_theme/R_Files/TOPMODEL/")
raster<-'hubbard_clipped.tif'
dem <-raster(raster)
image(dem)
dem <-as.matrix(dem)
is.na(dem)
new_dem=remove.na(dem, iftell = TRUE)
####################################################################
hubbard_raster<-raster("hubbard_clipped.tif")
plot(hubbard_raster)
hubbard_tiff<-readTIFF("hubbard_clipped.tif")
hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
hubbard_topidx<-make.classes(hubbard_topidx_big, 5)
hubbard_topidx_withdem<-make.classes(hubbard_topidx_big_withdem, 11)
hubbard_topidx
plot(hubbard_topidx)
hubbard_topidx_withdem
plot(hubbard_topidx_withdem)
hubbard_data<-read.csv("2016_hubbert_precip.csv")
hubbard_rain_mm<-hubbard_data$ï..Precip_2016_mm
hubbard_rain_m<-hubbard_data$ï..Precip_2016_m
hubbard_flow_ls<-hubbard_data$Streamflow_l.s
hubbard_flow_m3d<-hubbard_data$Streamflow_m3.day
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, delay, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow_ls)
View(dem)
hubbard_delay<-flowlength(dem,[218,858])*10
hubbard_delay<-flowlength(dem)*10
hubbard_delay<-make.classes(hubbard_delay,5)
hubbard_delay<-flowlength(dem)*10
hubbard_delay<-make.classes(hubbard_delay,5)
hubbard_delay <- hubbard_delay[n:1,]
hubbard_delay[,2] <- c(0, cumsum(hubbrd_delay[1:(n-1),2]))
hubbard_delay[,2] <- c(0, cumsum(hubbard_delay[1:(n-1),2]))
hubbard_delay_flow<-flowlength(dem)*10
hubbard_delay_flow
View(hubbard_delay_flow)
hubbard_delay_flow<-flowlength(dem)*10
hubbard_delay_flow
hubbard_delay_class<-make.classes(hubbard_delay_flow,5)
hubbard_delay_class
hubbard_delay_class<-make.classes(hubbard_delay_flow,10)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_class<-make.classes(hubbard_delay_flow,5)
plot(hubbard_delay_class)
hubbard_delay_class<-make.classes(hubbard_delay_flow,15)
plot(hubbard_delay_class)
hubbard_delay_class<-make.classes(hubbard_delay_flow,8)
plot(hubbard_delay_class)
hubbard_delay_class<-make.classes(hubbard_delay_flow,10)
plot(hubbard_delay_class)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_classorder<- hubbard_delay_class[n:1,]
hubbard_delay_classorder
delay
hubbard_delay_classorder
hubbard_delay_classorder<- hubbard_delay_class[10:1,]
hubbard_delay_classorder
hubbard_delay[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(n-1),2]))
k<-10
hubbard_delay_flow<-flowlength(dem)*10
hubbard_delay_class<-make.classes(hubbard_delay_flow,k)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_classorder<- hubbard_delay_class[k:1,]
hubbard_delay_classorder
hubbard_delay[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(k-1),2]))
k<-5
hubbard_delay_flow<-flowlength(dem)*10
hubbard_delay_class<-make.classes(hubbard_delay_flow,k)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_classorder<- hubbard_delay_class[k:1,]
hubbard_delay_classorder
hubbard_delay[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(k-1),2]))
k<-10
hubbard_delay_flow<-flowlength(dem)*10
hubbard_delay_class<-make.classes(hubbard_delay_flow,k)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_classorder<- hubbard_delay_class[k:1,]
hubbard_delay_classorder
delay
hubbard_delay[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(k-1),2]))
hubbard_delay_classorder[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(k-1),2]))
hubbard_delay_classorder
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue")
points(hubbard_flow_ls)
plot(hubbard_sim, type="l", col="blue", xlab="Days", ylab="Flow")
points(hubbard_flow_ls)
plot(hubbard_sim, type="l", col="blue", main="2018 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
points(hubbard_flow_ls)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, cex=0.8)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, pch=o)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, pch=0)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, cex=0.5)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, cex=0.8)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, cex=0.8)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2018 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
points(hubbard_flow_ls)
makePlot()
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1:2, cex=0.8)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, cex=0.8)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, cex=0.9)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, pch=o, cex=0.9)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, pch=O, cex=0.9)
line(hubbard_flow_ls)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2018 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
line(hubbard_flow_ls)
plot(hubbard_sim, type="l", col="blue", main="2018 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
lines(hubbard_flow_ls)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, cex=0.9)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
lines(hubbard_flow_ls)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, cex=0.9)
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot(Qsim, type="l", col="red")
lines(hubbard_sim, type="l", col="blue")
dt <- 0.25
parameters <- cbind(qs0,lnTe,m,Sr0,Srmax,td,vch,vr,k0,CD,dt)
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot(Qsim, type="l", col="red")
lines(hubbard_sim, type="l", col="blue")
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
plot(Qsim, type="l", col="red")
dt <- 24
parameters <- cbind(qs0,lnTe,m,Sr0,Srmax,td,vch,vr,k0,CD,dt)
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
lines(hubbard_flow_ls)
legend("topright", legend=c("modeled", "observed"),
col=c("blue", "black"), lty=1, cex=0.9)
hubbard_delay_classorder
dem[217,858]
delay
plot(hubbard_raster)
plot(hubbard_topidx)
plot(dem)
raster<-'hubbard_clipped.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
new_dem=remove.na(dem, iftell = TRUE)
min(dem)
max(dem)
is.na(atb)
plot(dem)
raster<-'hubbard_clipped.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
new_dem=remove.na(dem, iftell = TRUE)
plot(dem)
raster<-'hubbard_clipped.tif'
dem <-raster(raster)
plot(dem)
topidx
plot(topidx)
plot(hubbard_raster)
#hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(hubbard_raster, 10)$atb
#hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
dem <-as.matrix(dem)
is.na(dem)
new_dem=remove.na(dem, iftell = TRUE)
#hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
plot(dem)
plot(dem)
#hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
#hubbard_topidx<-make.classes(hubbard_topidx_big, 5)
hubbard_topidx_withdem<-make.classes(hubbard_topidx_big_withdem, 11)
#hubbard_topidx
plot(hubbard_topidx)
hubbard_topidx_withdem
plot(hubbard_topidx_withdem)
hubbard_data<-read.csv("2016_hubbert_precip.csv")
hubbard_rain_mm<-hubbard_data$ï..Precip_2016_mm
hubbard_rain_m<-hubbard_data$ï..Precip_2016_m
hubbard_flow_ls<-hubbard_data$Streamflow_l.s
hubbard_flow_m3d<-hubbard_data$Streamflow_m3.day
delay
k<-10
hubbard_delay_flow<-flowlength(dem)*10
hubbard_delay_flowlength<-flowlength(dem)*10
hubbard_delay_class<-make.classes(hubbard_delay_flowlength,k)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_classorder<- hubbard_delay_class[k:1,]
hubbard_delay_classorder
hubbard_delay_classorder[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(k-1),2]))
hubbard_delay_classorder
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_m, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_m, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
lines(hubbard_flow_ls)
points(hubbard_flow_ls)
points(hubbard_flow_m3d)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
points(hubbard_flow_m3d)
points(hubbard_flow_ls)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
points(hubbard_flow_ls)
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
getwd("C:/summer_institute_2019/Scaling_theme/R_Files/TOPMODEL/")
raster<-'hubbard_clipped.tif'
dem <-raster(raster)
plot(dem)
hubbard_delay_classorder
dem[217,858]
View(dem)
View(dem)
dem <-as.matrix(dem)
is.na(dem)
new_dem=remove.na(dem, iftell = TRUE)
plot(dem)
View(dem)
####################################################################
hubbard_raster<-raster("hubbard_clipped.tif")
plot(hubbard_raster)
#hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
hubbard_topidx_big_withdem<-topidx(dem, 10)$atb
#hubbard_topidx<-make.classes(hubbard_topidx_big, 5)
hubbard_topidx_withdem<-make.classes(hubbard_topidx_big_withdem, 11)
hubbard_topidx_withdem
hubbard_data<-read.csv("2016_hubbert_precip.csv")
hubbard_rain_mm<-hubbard_data$ï..Precip_2016_mm
hubbard_rain_m<-hubbard_data$ï..Precip_2016_m
hubbard_flow_ls<-hubbard_data$Streamflow_l.s
hubbard_flow_m3d<-hubbard_data$Streamflow_m3.day
k<-10
hubbard_delay_flowlength<-flowlength(dem)*10
hubbard_delay_class<-make.classes(hubbard_delay_flowlength,k)
hubbard_delay_class
plot(hubbard_delay_class)
hubbard_delay_classorder<- hubbard_delay_class[k:1,]
hubbard_delay_classorder
hubbard_delay_classorder[,2] <- c(0, cumsum(hubbard_delay_classorder[1:(k-1),2]))
hubbard_delay_classorder
hubbard_sim<-topmodel(parameters, hubbard_topidx_withdem, hubbard_delay_classorder, hubbard_rain_mm, ETp)
plot(hubbard_sim, type="l", col="blue", main="2016 Daily Flow for Hubbard Creek", xlab="Days", ylab="Flow")
dem
hubbard_topidx_withdem
typeof(hubbard_topidx_big_withdem)
hubbard_delay_class
hubbard_delay_classorder
hubbard_delay_classorder
hubbard_delay_flowlength
View(hubbard_delay_flowlength)
hubbard_delay_classorder
hubbard_topidx_withdem
Qsim <- topmodel(parameters,topidx, delay, rain, ETp)
plot(Qsim, type="l", col="red")
lines(hubbard_sim, type="l", col="blue")
Qsim
points(Qobs)
