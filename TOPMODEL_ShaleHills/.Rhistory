library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
##getwd("C:/summer_institute_2019/Scaling_theme/R_Files/TOPMODEL/")
raster<-'shales_clipped.tif'
dem <-raster(raster)
plot(dem)
##getwd("C:/summer_institute_2019/Scaling_theme/R_Files/TOPMODEL/")
raster<-'shales_clipped2.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
####################################################################
shale_raster<-raster("shales_clipped2")
####################################################################
shale_raster<-raster("shales_clipped2.tif")
plot(hubbard_raster)
plot(shale_raster)
#hubbard_topidx_big<-topidx(hubbard_tiff, 10)$atb
shale_topidx<-topidx(dem, 10)$atb
shale_topidx_wclass<-make.classes(shale_topidx, 11)
shale_topidx_wclass
shale_topidx_wclass<-make.classes(shale_topidx, 12)
plot(shale_topidx_wclass)
precip_data<-read.csv("2007-08-01_2007-10-31SSHCZOHourPrecipSH.csv")
shale_rain<-precip_data$Total_Precip_mm
shale_flowlength<-flowlength(dem)*3
shale_delay_class<-make.classes(shale_flowlength,k)
k<-10
shale_delay_class<-make.classes(shale_flowlength,k)
shale_delay_class
plot(shale_delay_class)
shale_delay_classorder<- shale_delay_class[k:1,]
shale_delay_classorder
shale_delay_classorder[,2] <- c(0, cumsum(shale_delay_classorder[1:(k-1),2]))
shale_delay_classorder
shale_sim<-topmodel(parameters, shale_topidx_wclass, shale_delay_classorder, shale_rain, ETp)
plot(shale_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Days", ylab="Flow")
dt <- 0.1667
parameters <- cbind(qs0,lnTe,m,Sr0,Srmax,td,vch,vr,k0,CD,dt)
shale_sim<-topmodel(parameters, shale_topidx_wclass, shale_delay_classorder, shale_rain, ETp)
plot(shale_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Days", ylab="Flow")
plot(shale_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="10min timestep", ylab="Flow")
dem<- sinkfill(dem, cellsize=3, degree=0.1)
dem<- sinkfill(dem, 3, degree=0.1)
shale_topidx<-topidx(dem, 10)$atb
shale_topidx_wclass<-make.classes(shale_topidx, 12)
shale_topidx_wclass
plot(shale_topidx_wclass)
shale_sim<-topmodel(parameters, shale_topidx_wclass, shale_delay_classorder, shale_rain, ETp)
plot(shale_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="10min timestep", ylab="Flow")
dem<- sinkfill(dem, 10, degree=0.1)
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
##getwd("C:/summer_institute_2019/Scaling_theme/R_Files/TOPMODEL/")
raster<-'shales_clipped2.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
plot(dem)
####################################################################
shale_raster<-raster("shales_clipped2.tif")
plot(shale_raster)
shale_topidx<-topidx(dem, 10)$atb
shale_topidx_class<-make.classes(shale_topidx, 11)
shale_topidx_class
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(hubbard_topidx_class)
plot(shale_topidx_class)
shale_topidx_class<-make.classes(shale_topidx, 20)
shale_topidx_class
plot(shale_topidx_class)
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(shale_topidx_class)
dem_sink<- sinkfill(dem, 3, degree=0.1)
shale_sink_topidx<-topidx(dem_sink, 10)$atb
shale__sink_topidx_wclass<-make.classes(shale_sink_topidx, 12)
shale__sink_topidx_wclass
plot(shale_sink_topidx_wclass)
shale__sink_topidx_wclass
plot(shale_sink_topidx_wclass)
shale_sink_topidx_wclass<-make.classes(shale_sink_topidx, 12)
shale_sink_topidx_wclass
plot(shale_sink_topidx_wclass)
plot(shale_topidx_class)
View(dem)
summary(shale_raster)
####################################################################
shale_raster<-raster("shales_clipped2.tif")
plot(shale_raster)
shale_raster
shale_topidx<-topidx(dem, 3)$atb
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(shale_topidx_class)
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
raster<-'shales_clipped2.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
plot(dem)
####################################################################
shale_raster<-raster("shales_clipped2.tif")
plot(shale_raster)
shale_topidx<-topidx(dem, 3)$atb
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(shale_topidx_class)
dem_sink<- sinkfill(dem, 3, degree=0.1)
shale_sink_topidx<-topidx(dem_sink, 10)$atb
shale_sink_topidx_wclass<-make.classes(shale_sink_topidx, 12)
shale_sink_topidx_wclass
plot(shale_sink_topidx_wclass)
data_aug_oct<-read.csv("2007-08-01_2007-10-31SSHCZOHourPrecipSH.csv")
data_jan-dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
data_aug_oct<-read.csv("2007-08-01_2007-10-31SSHCZOHourPrecipSH.csv")
data_jan-dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
data_jan_dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
aug_oct_rain<-data_aug_oct$Precip_m
jan_dec_rain<-data_jan_dec$Precip_m
delay
shale_flowlength<-flowlength(dem)*3
shale_delay_class<-make.classes(shale_flowlength,k)
k<-10
shale_flowlength<-flowlength(dem)*3
shale_delay_class<-make.classes(shale_flowlength,k)
shale_delay_class
plot(shale_delay_class)
shale_delay_classorder<- shale_delay_class[k:1,]
shale_delay_classorder
shale_delay_classorder[,2] <- c(0, cumsum(shale_delay_classorder[1:(k-1),2]))
shale_delay_classorder
shale_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain, ETp)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain, ETp)
jan_dec_rain
length(jan_dec_rain)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain, ETp)
typeof(jan_dec_rain)
max(jan_dec_rain)
jan_dec_rain
max(jan_dec_rain, na.rm=true)
max(jan_dec_rain, na.rm=TRUE)
length(jan_dec_rain, na.rm=TRUE)
length(jan_dec_rain, na.rm=TRUE)
max(jan_dec_rain, na.rm=TRUE)
length(jan_dec_rain, na.rm=TRUE)
aug_oct_rain_noNA <- aug_oct_rain[!is.na(aug_oct_rain)]
length(aug_oct_rain)
length(aug_oct_rain_noNA)
length(jan_dec_rain)
jan_dec_rain_noNA <- jan_dec_rain[!is.na(jan_dec_rain)]
length(jan_dec_rain_noNA)
data_aug_oct<-read.csv("2007-08-01_2007-10-31SSHCZOHourPrecipSH.csv")
data_jan_dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
aug_oct_rain<-data_aug_oct$Precip_m
length(aug_oct_rain)
jan_dec_rain<-data_jan_dec$Precip_m
length(jan_dec_rain)
jan_dec_rain_noNA <- jan_dec_rain[!is.na(jan_dec_rain)]
length(jan_dec_rain_noNA)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain_noNA, ETp)
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (cmd)")
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
aug_oct_flow<-data_aug_oct$hourly_discharge_m.s
jan_dec_flow<-data_jan_dec$hourly_discharge_m.s
jan_dec_flow<-jan_dec_flow[!is.na(jan_dec_flow)]
length(jan_dec_flow)
shale_raster
View(shale_raster)
View(dem)
plot(jan_dec_flow)
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
jan_dec_flow<-data_jan_dec$hourly_discharge_cms
jan_dec_flow<-jan_dec_flow[!is.na(jan_dec_flow)]
length(jan_dec_flow)
plot(jan_dec_flow)
plot(jan_dec_flow, lty="l")
plot(jan_dec_flow, type="l")
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(jan_dec_flow, type="l")
aug_dec_sim<-topmodel(parameters,shale_topidx_class, shale_delay_class, aug_oct_rain, ETp)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain_noNA, ETp)
aug_dec_sim<-topmodel(parameters,shale_topidx_class, shale_delay_class, aug_oct_rain, ETp)
aug_dec_sim<-topmodel(parameters,shale_topidx_class, shale_delay_class, aug_oct_rain_noNA, ETp)
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
raster<-'shales_clipped2.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
plot(dem)
shale_topidx<-topidx(dem, 3)$atb
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(shale_topidx_class)
data_aug_oct<-read.csv("2007-08-01_2007-10-31SSHCZOHourPrecipSH.csv")
data_jan_dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
aug_oct_rain<-data_aug_oct$Precip_m
length(aug_oct_rain)
aug_oct_rain_noNA <- aug_oct_rain[!is.na(aug_oct_rain)]
length(aug_oct_rain_noNA)
jan_dec_rain<-data_jan_dec$Precip_m
length(jan_dec_rain)
jan_dec_rain_noNA <- jan_dec_rain[!is.na(jan_dec_rain)]
length(jan_dec_rain_noNA)
aug_oct_flow<-data_aug_oct$hourly_discharge_m.s
jan_dec_flow<-data_jan_dec$hourly_discharge_cms
jan_dec_flow<-jan_dec_flow[!is.na(jan_dec_flow)]
length(jan_dec_flow)
k<-10
shale_flowlength<-flowlength(dem)*3
shale_delay_class<-make.classes(shale_flowlength,k)
shale_delay_class
plot(shale_delay_class)
shale_delay_classorder<- shale_delay_class[k:1,]
shale_delay_classorder
shale_delay_classorder[,2] <- c(0, cumsum(shale_delay_classorder[1:(k-1),2]))
shale_delay_classorder
aug_dec_sim<-topmodel(parameters,shale_topidx_class, shale_delay_class, aug_oct_rain_noNA, ETp)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain_noNA, ETp)
aug_dec_sim<-topmodel(parameters,shale_topidx_class, shale_delay_classorder, aug_oct_rain_noNA, ETp)
aug_oct_sim<-topmodel(parameters,shale_topidx_class, shale_delay_classorder, aug_oct_rain_noNA, ETp)
aug_oct_sim<-topmodel(parameters,shale_topidx_class, shale_delay_classorder, aug_oct_rain_noNA, ETp)
plot(aug_oct_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(aug_oct_flow, type="l")
plot(aug_oct_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(aug_oct_flow, type="l")
aug_oct_flow<-data_aug_oct$hourly_discharge_cms
plot(aug_oct_flow, type="l")
plot(aug_oct_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(aug_oct_flow, type="l")
plot(aug_oct_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(aug_oct_flow, type="l")
aug_oct_flow<-data_aug_oct$hourly_discharge_m.s
plot(aug_oct_flow, type="l")
plot(aug_oct_sim, type="l", col="blue", main="Aug1-Oct31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(jan_dec_flow, type="l")
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
dt <- 1
parameters <- cbind(qs0,lnTe,m,Sr0,Srmax,td,vch,vr,k0,CD,dt)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain_noNA, ETp)
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
####################################################################
shale_raster<-raster("shales_clipped2.tif")
plot(shale_raster)
shale_raster
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(shale_raster)
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain_noNA, ETp)
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
data_10min<-read.csv("ShaleHills_data.csv")
flow_10min<-data_10min$Discharge_.cmd.
plot(flow_10min)
plot(flow_10min[0:20000])
plot(flow_10min[0:5000])
plot(flow_10min[0:1000])
plot(flow_10min)
data_jan_dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
jan_dec_rain<-data_jan_dec$Precip_m
length(jan_dec_rain)
jan_dec_flow<-data_jan_dec$hourly_discharge_cms
length(jan_dec_flow)
plot(jan_dec_flow)
plot(jan_dec_flow, type="l")
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
plot(jan_dec_flow, type="l")
shale_topidx<-topidx(dem, 3)$atb
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(shale_topidx_class)
#data_aug_oct<-read.csv("2007-08-01_2007-10-31SSHCZOHourPrecipSH.csv")
data_jan_dec<-read.csv("2007-01-01_2007-12-31SSHCZOHourPrecipSH.csv")
#aug_oct_rain<-data_aug_oct$Precip_m
#length(aug_oct_rain)
#aug_oct_rain_noNA <- aug_oct_rain[!is.na(aug_oct_rain)]
#length(aug_oct_rain_noNA)
jan_dec_rain<-data_jan_dec$Precip_m
length(jan_dec_rain)
#jan_dec_rain_noNA <- jan_dec_rain[!is.na(jan_dec_rain)]
#length(jan_dec_rain_noNA)
#aug_oct_flow<-data_aug_oct$hourly_discharge_m.s
jan_dec_flow<-data_jan_dec$hourly_discharge_cms
#jan_dec_flow<-jan_dec_flow[!is.na(jan_dec_flow)]
length(jan_dec_flow)
k<-10
shale_flowlength<-flowlength(dem)*3
shale_delay_class<-make.classes(shale_flowlength,k)
shale_delay_class
plot(shale_delay_class)
shale_delay_classorder<- shale_delay_class[k:1,]
shale_delay_classorder
shale_delay_classorder[,2] <- c(0, cumsum(shale_delay_classorder[1:(k-1),2]))
shale_delay_classorder
jan_dec_sim<-topmodel(parameters, shale_topidx_class, shale_delay_classorder, jan_dec_rain_noNA, ETp)
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
lines(jan_dec_flow, type="l")
plot(jan_dec_flow, type="l")
plot(jan_dec_sim, type="l", col="blue", main="Jan1-Dec31 2007", xlab="Hour", ylab="Discharge (m/s)")
library(readxl)
library(topmodel)
library(Hmisc)
library(tiff)
library(raster)
library(rgdal)
library(gdata)
data(huagrahuma)
data(huagrahuma.dem)
attach(huagrahuma)
raster<-'shales_clipped2.tif'
dem <-raster(raster)
plot(dem)
dem <-as.matrix(dem)
is.na(dem)
plot(dem)
####################################################################
shale_raster<-raster("shales_clipped2.tif")
plot(shale_raster)
shale_raster
shale_topidx<-topidx(dem, 3)$atb
shale_topidx_class<-make.classes(shale_topidx, 12)
shale_topidx_class
plot(shale_topidx_class)
dem_sink<- sinkfill(dem, 3, degree=0.1)
shale_sink_topidx<-topidx(dem_sink, 10)$atb
shale_sink_topidx_wclass<-make.classes(shale_sink_topidx, 12)
shale_sink_topidx_wclass
plot(shale_sink_topidx_wclass)
